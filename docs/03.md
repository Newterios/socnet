# 03 Diagrams

## Purpose
This document explains the diagrams of the SocialNet project and how they describe the system. The images are stored in `docs/diagrams/exported/`.

## Diagram Index
1. Use Case Diagram  
   Path: `docs/diagrams/exported/use_case_socialnet.png`

2. ERD Diagram  
   Path: `docs/diagrams/exported/erd_socialnet.png`

3. UML Class Diagram  
   Path: `docs/diagrams/exported/uml_class_socialnet.png`

4. Sequence Diagram - Create Post  
   Path: `docs/diagrams/exported/sequence_create_post.png`

## 1) Use Case Diagram
The use case diagram shows what the system allows users to do and which roles can access each action.

### Actors
- Guest
    - Can register and view public profiles.
- User
    - Can manage profile and content, interact with other users, and use messaging and groups.
- Admin
    - Can review reports and moderate content.

### Main Use Cases
- Account
    - Register
    - Login
    - View Public Profiles
- Profile and Content
    - Edit Profile
    - Create Post
    - Edit Post
    - Delete Post
    - View Feed
    - Like Post
    - Comment on Post
- Social and Messaging
    - Send Friend Request
    - Accept Friend Request
    - Block User
    - Send Message
- Groups
    - Create Group
    - Join Group
- Moderation
    - Report Content
    - Review Reports (Admin)
    - Delete Reported Content (Admin)

This diagram covers the MVP functions for a typical social network: posts, likes, comments, friendships, messages, groups, and reporting.

## 2) ERD Diagram (Database Model)
The ERD describes the database tables and relationships.

### Core Tables
- users
    - Stores user profile and identity data.
- posts
    - Stores user posts.
- comments
    - Stores comments under posts.
- likes
    - Stores likes made by users.
- friendships
    - Stores friend request and friendship status between two users.
- conversations
    - Stores chat conversations.
- conversation_members
    - Connects users to conversations (many-to-many).
- messages
    - Stores messages sent by users in conversations.
- groups
    - Stores created groups.
- group_members
    - Connects users to groups (many-to-many).
- reports
    - Stores reports created by users about content or users.
- notifications
    - Stores notifications connected to user actions (for example post activity).

### Main Relationships (High Level)
- users to posts
    - One user creates many posts.
- posts to comments
    - One post has many comments.
- users to comments
    - One user writes many comments.
- users to likes and posts to likes
    - A like connects a user and a post (many-to-many through likes).
- friendships
    - A friendship connects two users using requester and addressee roles.
- conversations and members
    - conversations to users is many-to-many via conversation_members.
- conversations to messages
    - One conversation has many messages.
- users to messages
    - One user sends many messages.
- groups and members
    - groups to users is many-to-many via group_members.
    - groups has an owner user.
- reports
    - One user (reporter) creates many reports.
    - A report points to a target (content or user) based on design.
- notifications
    - Notifications belong to users and can be triggered by actions like posts or reports.

### Notes
- Many-to-many relations are modeled using linking tables:
    - conversation_members
    - group_members
    - likes
- Friendships are modeled as a separate table because the relation needs status (pending, accepted, blocked).

## 3) UML Class Diagram
The UML class diagram describes the domain model (entities) and their connections.

### Main Classes
- User
    - id, email, username, fullName, bio, avatarURL
- Post
    - id, content, mediaURL, createdAt
- Comment
    - id, content, createdAt
- Like
    - id, createdAt
- Friendship
    - id, status, createdAt
- Conversation
    - id, createdAt
- Message
    - id, body, createdAt, readAt
- Group
    - id, title, description
- Report
    - id, targetType, targetId, reason, status

### Relationships (Aligned with ERD)
- User creates many Post
- Post has many Comment
- User writes many Comment
- User adds many Like
- Friendship connects User to User (requester and addressee)
- User sends Message
- Conversation contains Message
- User owns Group and user membership is many-to-many
- User creates Report

The UML diagram is consistent with the ERD, but focuses on the objects and their attributes used in the application logic.

## 4) Sequence Diagram - Create Post
The sequence diagram shows the request flow when a user publishes a post.

### Flow
1. User writes a post in the Web Client and clicks Publish.
2. Web Client sends `POST /posts (content)` to the HTTP Handler.
3. HTTP Handler calls `CreatePost(userId, content)` in PostService.
4. PostService calls `InsertPost(post)` in PostRepository.
5. PostRepository executes `INSERT INTO posts ...` in the DB.
6. DB returns success and a generated postId.
7. Repository returns postId to the service.
8. Service returns the created post to the handler.
9. Handler returns `201 Created (post)` to the Web Client.
10. Web Client shows the new post in the feed.

### Why this is useful
This diagram proves the separation of responsibilities:
- HTTP Handler handles transport and request validation.
- Service contains business logic.
- Repository isolates database access.
- DB stores the final data.

## Summary
All diagrams together describe the system from different perspectives:
- Use Case explains user goals and roles.
- ERD explains storage structure and relationships.
- UML explains the domain model for implementation.
- Sequence explains the runtime flow for a key feature (Create Post).
